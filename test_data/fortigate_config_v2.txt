config system global
    set hostname "fw-dc1-edge-01"
    set hostname-fqdn "fw-dc1-edge-01.corp.example.com"
end

config system dns
    set primary 10.0.0.53
    set secondary 10.0.0.55
end

config system ntp
    set ntpsync enable
    set type custom
    config ntpserver
        edit 1
            set server "10.0.0.10"
        next
    end
    config ntpserver
        edit 2
            set server "10.0.0.11"
        next
    end
    config ntpserver
        edit 3
            set server "10.0.0.12"
        next
    end
end

config system interface
    edit "wan1"
        set alias "ISP-Primary"
        set mode static
        set ip 203.0.113.1 255.255.255.252
        set status up
        set allowaccess ping
    next
end

config system interface
    edit "wan2"
        set alias "ISP-Backup - MAINTENANCE"
        set mode static
        set ip 198.51.100.1 255.255.255.252
        set status down
        set allowaccess ping
    next
end

config system interface
    edit "port1"
        set alias "LAN-Servers"
        set mode static
        set ip 10.10.1.1 255.255.255.0
        set status up
        set allowaccess ping https ssh
    next
end

config system interface
    edit "port2"
        set alias "LAN-Users"
        set mode static
        set ip 10.10.2.1 255.255.255.0
        set status up
        set allowaccess ping
    next
end

config system interface
    edit "port3"
        set alias "DMZ"
        set mode static
        set ip 172.16.1.1 255.255.255.0
        set status up
        set allowaccess ping
    next
end

config system interface
    edit "port4"
        set alias "Guest-WiFi"
        set mode static
        set ip 10.10.3.1 255.255.255.0
        set status up
        set allowaccess ping
    next
end

config system interface
    edit "loopback0"
        set alias "Router-ID"
        set mode static
        set ip 10.255.0.1 255.255.255.255
        set status up
        set type loopback
    next
end

config system interface
    edit "vlan100"
        set vdom "root"
        set type vlan
        set vlanid 100
        set alias "MGMT"
        set interface "port1"
    next
end

config system interface
    edit "vlan200"
        set vdom "root"
        set type vlan
        set vlanid 200
        set alias "VOIP"
        set interface "port2"
    next
end

config system interface
    edit "vlan300"
        set vdom "root"
        set type vlan
        set vlanid 300
        set alias "IOT"
        set interface "port2"
    next
end

config router static
    edit 1
        set dst 0.0.0.0 0.0.0.0
        set gateway 203.0.113.2
        set comment "Default via ISP-Primary"
    next
    edit 3
        set dst 10.20.0.0 255.255.0.0
        set gateway 10.10.1.254
        set comment "Remote-Office-Network"
    next
    edit 4
        set dst 10.30.0.0 255.255.0.0
        set gateway 10.10.1.253
        set comment "Branch-Office-Network"
    next
end

config router bgp
    set as 65001
    set router-id 10.255.0.1
    set log-neighbour-changes enable
    config neighbor
        edit "203.0.113.2"
            set remote-as 65000
            set description "ISP-Primary"
        next
    end
    config network
        edit 1
            set prefix 10.10.0.0/16
        next
        edit 2
            set prefix 10.30.0.0/16
        next
    end
    config redistribute "connected"
        set status enable
    end
    config redistribute "static"
        set status enable
    end
end

config router prefix-list
    edit "OUTBOUND-FILTER"
        config rule
            edit 10
                set action permit
                set prefix 10.10.0.0/16
            next
            edit 15
                set action permit
                set prefix 10.30.0.0/16
            next
            edit 20
                set action deny
                set prefix 0.0.0.0/0
                set le 32
            next
        end
    next
end

config firewall address
    edit "LAN-Servers-Net"
        set type ipmask
        set subnet 10.10.1.0 255.255.255.0
    next
end

config firewall address
    edit "LAN-Users-Net"
        set type ipmask
        set subnet 10.10.2.0 255.255.255.0
    next
end

config firewall address
    edit "DMZ-Net"
        set type ipmask
        set subnet 172.16.1.0 255.255.255.0
    next
end

config firewall address
    edit "Guest-Net"
        set type ipmask
        set subnet 10.10.3.0 255.255.255.0
    next
end

config firewall policy
    edit 1
        set name "Users-to-Internet"
        set srcintf "port2"
        set dstintf "wan1"
        set srcaddr "LAN-Users-Net"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
        set logtraffic all
    next
    edit 2
        set name "Servers-to-Internet"
        set srcintf "port1"
        set dstintf "wan1"
        set srcaddr "LAN-Servers-Net"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "HTTP" "HTTPS" "DNS" "NTP"
        set nat enable
        set logtraffic all
    next
    edit 3
        set name "DMZ-Inbound-HTTPS"
        set srcintf "wan1"
        set dstintf "port3"
        set srcaddr "all"
        set dstaddr "DMZ-Net"
        set action accept
        set schedule "always"
        set service "HTTPS"
        set logtraffic all
    next
    edit 4
        set name "Guest-to-Internet"
        set srcintf "port4"
        set dstintf "wan1"
        set srcaddr "Guest-Net"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "HTTP" "HTTPS" "DNS"
        set nat enable
        set logtraffic all
        set comments "Guest WiFi - restricted services"
    next
    edit 100
        set name "Deny-All"
        set srcintf "any"
        set dstintf "any"
        set srcaddr "all"
        set dstaddr "all"
        set action deny
        set schedule "always"
        set service "ALL"
        set logtraffic all
    next
end
